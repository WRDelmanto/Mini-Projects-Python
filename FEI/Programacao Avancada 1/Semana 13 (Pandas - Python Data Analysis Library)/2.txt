# coding: utf-8

import pandas

def Substitute(dataframe, coluna, valor, por):
    dataframe[coluna] = dataframe[coluna].astype(str).str.replace(valor, por)
    
    return(dataframe)

def Convert(dataframe, coluna, type = 'string'):
    dataframe[coluna] = dataframe[coluna].astype(type)
    
    return (dataframe)

dataframe = pandas.read_csv('municipios_fronteiricos.csv')

dataframe = Substitute(dataframe, 'Densidade demográfica (hab/km2)', ',', '.')
dataframe = Substitute(dataframe, 'PIB (IBGE/2005', '.', '')
dataframe = Substitute(dataframe, 'PIB (IBGE/2005', ' ', '')
dataframe = Substitute(dataframe, 'PIB per capita (R$)', '.', '')
dataframe = Substitute(dataframe, 'PIB per capita (R$)', ' ', '')
dataframe = Substitute(dataframe, 'IDH/2000', ',', '.')
dataframe = Substitute(dataframe, 'IDH/2000', 'ni', '0')

dataframe = Convert(dataframe, 'Densidade demográfica (hab/km2)', float)
dataframe = Convert(dataframe, 'PIB (IBGE/2005', float)
dataframe = Convert(dataframe, 'PIB per capita (R$)', float)
dataframe = Convert(dataframe, 'IDH/2000', float)

print('Média populacional: ', dataframe['População (IBGE/2007)'].mean())

dataframe = dataframe.sort_values(by='Área territorial', ascending=True)
print('Município com menor área: ', dataframe['Município'].iloc[0])

dataframe = dataframe.sort_values(by='Área territorial', ascending=False)
print('Município com maior área: ', dataframe['Município'].iloc[0])

dataframe = dataframe.sort_values(by='IDH/2000', ascending=True)
print('Município com menor IDH: ', dataframe['Município'].iloc[0])

dataframe = dataframe.sort_values(by='PIB per capita (R$)', ascending=False)
print('Município com maior Renda Per Capita: ', dataframe['Município'].iloc[0])